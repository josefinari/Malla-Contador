<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Malla Curricular Contador Público</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #faf8fb;
        margin: 0;
        padding: 0;
        color: #333;
    }
    h1 {
        text-align: center;
        padding: 20px;
    }
    .container {
        display: flex;
        gap: 10px;
        padding: 10px;
        overflow-x: auto;
    }
    .column {
        flex: 1;
        min-width: 220px;
        padding: 10px;
        border-radius: 10px;
    }
    .materia {
        background: white;
        padding: 8px;
        margin: 5px 0;
        border-radius: 6px;
        cursor: pointer;
        position: relative;
        transition: background 0.3s, opacity 0.3s;
    }
    .materia.aprobada {
        background: #c8f7c5;
        text-decoration: line-through;
    }
    .materia.bloqueada {
        background: #f0f0f0;
        color: #aaa;
        cursor: not-allowed;
    }
    /* Tooltip invisible por defecto */
    .tooltip {
        visibility: hidden;
        opacity: 0;
        background: rgba(0,0,0,0.8);
        color: #fff;
        text-align: center;
        border-radius: 5px;
        padding: 5px;
        position: absolute;
        z-index: 10;
        left: 105%;
        top: 50%;
        transform: translateY(-50%);
        white-space: nowrap;
        transition: opacity 0.3s;
        font-size: 0.8em;
    }
    .materia:hover .tooltip {
        visibility: visible;
        opacity: 1;
    }
    /* Colores de columnas (paleta) */
    .col1 { background: #B299D4; }
    .col2 { background: #E3A6D0; }
    .col3 { background: #E680B4; }
    .col4 { background: #E46094; }
    .col5 { background: #E56F6F; }
</style>
</head>
<body>

<h1>Malla Curricular - Contador Público</h1>
<div class="container">
    <!-- Primer Tramo -->
    <div class="column col1">
        <h3>Primer Tramo</h3>
        <div class="materia" data-id="245">245 Álgebra</div>
        <div class="materia" data-id="241">241 Análisis Matemático I</div>
        <div class="materia" data-id="242">242 Economía</div>
        <div class="materia" data-id="246">246 Historia económica y social general</div>
        <div class="materia" data-id="244">244 Metodología de las Ciencias Sociales</div>
        <div class="materia" data-id="243">243 Sociología</div>
    </div>

    <!-- Segundo Tramo -->
    <div class="column col2">
        <h3>Segundo Tramo</h3>
        <div class="materia" data-id="248" data-req="245,241,242,246,244,243">248 Estadística I<span class="tooltip"></span></div>
        <div class="materia" data-id="252" data-req="245,241,242,246,244,243">252 Administración General<span class="tooltip"></span></div>
        <div class="materia" data-id="250" data-req="245,241,242,246,244,243">250 Microeconomía I<span class="tooltip"></span></div>
        <div class="materia" data-id="247" data-req="245,241,242,246,244,243">247 Teoría contable<span class="tooltip"></span></div>
        <div class="materia" data-id="249" data-req="245,241,242,246,244,243">249 Historia económica y social argentina<span class="tooltip"></span></div>
        <div class="materia" data-id="251" data-req="245,241,242,246,244,243">251 Instituciones de Derecho Público<span class="tooltip"></span></div>
    </div>

    <!-- Ciclo Profesional -->
    <div class="column col3">
        <h3>Ciclo Profesional</h3>
        <div class="materia" data-id="274" data-req="252">274 Sistemas Administrativos<span class="tooltip"></span></div>
        <div class="materia" data-id="275" data-req="274">275 Tecnología de la información<span class="tooltip"></span></div>
        <div class="materia" data-id="278" data-req-min="2">278 Macroeconomía y Política económica<span class="tooltip"></span></div>
        <div class="materia" data-id="276" data-req="248">276 Cálculo financiero<span class="tooltip"></span></div>
        <div class="materia" data-id="351" data-req="247">351 Sistemas Contables<span class="tooltip"></span></div>
        <div class="materia" data-id="279" data-req="276">279 Administración Financiera<span class="tooltip"></span></div>
        <div class="materia" data-id="353" data-req="247">353 Sistemas de Costos<span class="tooltip"></span></div>
        <div class="materia" data-id="1359" data-req-min="2">1359 Derecho Económico<span class="tooltip"></span></div>
        <div class="materia" data-id="1352" data-req="351,353">1352 Contabilidad Financiera<span class="tooltip"></span></div>
        <div class="materia" data-id="362" data-req="353">362 Gestión y costos para contadores<span class="tooltip"></span></div>
        <div class="materia" data-id="273" data-req="1359">273 Instituciones de Derecho Privado<span class="tooltip"></span></div>
        <div class="materia" data-id="1330" data-req="1352">1330 Contabilidad Social y Ambiental<span class="tooltip"></span></div>
        <div class="materia" data-id="356" data-req="251,1352">356 Teoría y Técnica impositiva I<span class="tooltip"></span></div>
        <div class="materia" data-id="1374" data-req="1352,278">1374 Contabilidad Gubernamental y Control de Gestión<span class="tooltip"></span></div>
        <div class="materia" data-id="354" data-req="251,1359">354 Derecho del Trabajo y de la Seguridad Social<span class="tooltip"></span></div>
        <div class="materia" data-id="355" data-req="362,1352">355 Auditoría<span class="tooltip"></span></div>
        <div class="materia" data-id="1358" data-req="355,1360">1358 Taller de Actuación Profesional Judicial<span class="tooltip"></span></div>
        <div class="materia" data-id="357" data-req="356">357 Teoría y Técnica impositiva II<span class="tooltip"></span></div>
        <div class="materia" data-id="1361" data-req-faltan="5">1361 Taller de Práctica Profesional en Organizaciones<span class="tooltip"></span></div>
        <div class="materia" data-id="1360" data-req="273,354">1360 Derecho, Crédito, Bursátil e Insolvencia<span class="tooltip"></span></div>
        <div class="materia" data-id="opt" data-req-min-ciclo="1">Materia Optativa<span class="tooltip"></span></div>
    </div>
</div>

<script>
const materias = document.querySelectorAll('.materia');
let aprobadas = JSON.parse(localStorage.getItem('aprobadas') || '[]');

function actualizarEstado() {
    materias.forEach(m => {
        let id = m.dataset.id;
        m.classList.remove('aprobada', 'bloqueada');
        m.querySelector('.tooltip')?.remove();

        let bloqueada = false;
        let faltan = [];

        if (m.dataset.req) {
            let reqs = m.dataset.req.split(',');
            reqs.forEach(r => {
                if (!aprobadas.includes(r)) faltan.push(r);
            });
            if (faltan.length) bloqueada = true;
        }
        if (m.dataset.reqMin) {
            let aprobadasSegundoTramo = [...document.querySelectorAll('.col2 .materia')]
                .filter(x => aprobadas.includes(x.dataset.id)).length;
            if (aprobadasSegundoTramo < m.dataset.reqMin) {
                bloqueada = true;
                faltan.push(`al menos ${m.dataset.reqMin} del segundo tramo`);
            }
        }
        if (m.dataset.reqFaltan) {
            let totalMaterias = document.querySelectorAll('.materia').length;
            let faltantes = totalMaterias - aprobadas.length;
            if (faltantes > m.dataset.reqFaltan) {
                bloqueada = true;
                faltan.push(`que solo falten ${m.dataset.reqFaltan} materias`);
            }
        }
        if (m.dataset.reqMinCiclo) {
            let aprobadasCiclo = [...document.querySelectorAll('.col3 .materia')]
                .filter(x => aprobadas.includes(x.dataset.id)).length;
            if (aprobadasCiclo < m.dataset.reqMinCiclo) {
                bloqueada = true;
                faltan.push(`al menos ${m.dataset.reqMinCiclo} del ciclo profesional`);
            }
        }

        if (bloqueada && !aprobadas.includes(id)) {
            m.classList.add('bloqueada');
            let tooltip = document.createElement('span');
            tooltip.className = 'tooltip';
            tooltip.textContent = `Bloqueada — falta: ${faltan.join(', ')}`;
            m.appendChild(tooltip);
        } else if (aprobadas.includes(id)) {
            m.classList.add('aprobada');
        }
    });
}

materias.forEach(m => {
    m.addEventListener('click', () => {
        let id = m.dataset.id;
        if (m.classList.contains('bloqueada')) return;
        if (aprobadas.includes(id)) {
            aprobadas = aprobadas.filter(x => x !== id);
        } else {
            aprobadas.push(id);
        }
        localStorage.setItem('aprobadas', JSON.stringify(aprobadas));
        actualizarEstado();
    });
});

actualizarEstado();
</script>
</body>
</html>
